"use strict";(self.webpackChunkextension=self.webpackChunkextension||[]).push([[2319],{85241:(e,t,n)=>{n.r(t),n.d(t,{CreateSharedPostModal:()=>C,default:()=>O});var r=n(51911),a=n(70468),l=n(53767),o=n(44194),i=n(49110),s=n(20316),u=n(21612),c=n(14149),d=n(90120),m=n(84187),p=n(40701),f=n(30413),v=n(62673),y=n(42520),g=n(45557),h=n(45018),b=n(87564),w=n(513),x=n(43741),S=n(9392),N=n(54480),P=["preview","squad","onSharedSuccessfully","onRequestClose"],k=o.createElement;function C(e){var t,n,C,O=e.preview,E=e.squad,L=e.onSharedSuccessfully,_=e.onRequestClose,j=(0,l.Z)(e,P),q=(0,o.useRef)(),D=(0,o.useState)(null!==(t=null!==(n=null==O?void 0:O.permalink)&&void 0!==n?n:null==O?void 0:O.url)&&void 0!==t?t:""),T=D[0],z=D[1],Z=(0,x.j)(),A=Z.shouldShowCta,I=Z.isEnabled,R=Z.onToggle,M=Z.onSubmitted,F=(0,d.x)({initialPreview:O,onPostSuccess:function(){L&&L(),M(),_(null)}}),U=F.getLinkPreview,W=F.isLoadingPreview,$=F.preview,H=F.isPosting,J=F.onSubmitPost,X=[null==$?void 0:$.url,null==$?void 0:$.permalink],B=(0,w.g)(U,(function(e){return X.every((function(t){return t!==e}))})),K=(0,a.Z)(B,1)[0],Q=k(o.Fragment,null,k(m.zx,{icon:k(v.l,null),size:p.qE.Small,variant:p.Wu.Tertiary,onClick:null==q||null===(C=q.current)||void 0===C?void 0:C.onMentionCommand}),k(y.i,{vertical:!0}),k(h.Z,{source:E,size:N.$C.Small}),k("span",{className:"-ml-1 flex-1"},k("strong",null,E.name),k("span",{className:"ml-1 text-text-tertiary"},"@",E.handle))),V={color:f.S.Cabbage,variant:p.Wu.Primary,disabled:H,loading:H};return k(i.u_,(0,r.Z)({kind:i.u_.Kind.FlexibleCenter,size:i.u_.Size.Medium,onRequestClose:_},j,{formProps:{form:"share_post",title:"New post",rightButtonProps:V,copy:{right:"Post"}}}),k(i.u_.Header,{title:"New post"}),k("form",{className:"flex w-full flex-col p-3",action:"#",onSubmit:function(e){e.preventDefault();var t=(0,b.x)(e.currentTarget).commentary;return J(e,E.id,t)},id:"share_post"},k(s.Z,{ref:q,showUserAvatar:!0,textareaProps:{rows:5,name:"commentary"},sourceId:null==E?void 0:E.id,allowPreview:!1,enabledCommand:{mention:!0},footer:W?k(u.X,{link:T,className:"m-3 flex-col-reverse"}):k(c.A,{className:"m-3 !w-auto flex-col-reverse",preview:null!=$?$:O,link:T,onLinkChange:function(e){var t=e.currentTarget.value;z(t),K(t)}})}),A&&k(S.r,{"data-testid":"push_notification-switch",inputId:"push_notification-switch",name:"push_notification",labelClassName:"flex-1 font-normal",className:"py-3",compact:!1,checked:I,onToggle:R},"Receive updates whenever your Squad members engage with your post")),k("span",{className:"flex flex-row items-center gap-2 px-4 tablet:hidden"},Q),k(i.u_.Footer,{className:"typo-caption1",justify:g.WD.Start},Q,k(m.zx,(0,r.Z)({},V,{className:"ml-auto",form:"share_post"}),"Post")))}const O=C},14149:(e,t,n)=>{n.d(t,{A:()=>f});var r=n(44194),a=n(32298),l=n(68353),o=n(2041),i=n(82731),s=n(94789),u=n(25665),c=n(84187),d=n(40701),m=n(54480),p=r.createElement;function f(e){var t,n,r=e.link,f=e.preview,v=e.onLinkChange,y=e.className,g=e.isMinimized,h=e.showPreviewLink,b=void 0===h||h;return p(u.$i,{className:y},b&&p(a.n,{leftIcon:p(l.x,null),label:"URL",type:"url",name:"url",inputId:"preview_url",fieldType:"tertiary",className:{container:"w-full"},value:r,onInput:v}),f.title&&f.image&&p(u.S5,{className:g&&"!px-3 !py-2"},p("div",{className:"flex flex-1 flex-col typo-footnote"},p("span",{className:"line-clamp-2 font-bold"},f.title),"unknown"!==(null===(t=f.source)||void 0===t?void 0:t.id)&&(g?p(i.e,{size:m.$C.Small,source:f.source,className:"absolute right-24 mr-4 mt-1"}):p("span",{className:"mt-1 flex flex-row items-center"},p(i.e,{size:m.$C.Small,source:f.source}),p("span",{className:"text-text-tertiary"},null===(n=f.source)||void 0===n?void 0:n.name)))),p(s.E,{className:u.JE,src:f.image,alt:"".concat(f.title)}),!g&&p(c.zx,{icon:p(o.h,null),variant:d.Wu.Tertiary,type:"button",tag:"a",target:"_blank",rel:"noopener noreferrer",href:r})))}},21612:(e,t,n)=>{n.d(t,{X:()=>m});var r=n(44194),a=n(32298),l=n(37730),o=n(62130),i=n(2041),s=n(25665),u=n(84187),c=n(40701),d=r.createElement;function m(e){var t=e.link,n=e.className;return d(s.$i,{className:n},d(a.n,{leftIcon:d(l.a,{className:"mr-2"}),label:"URL",type:"url",inputId:"preview_url",fieldType:"tertiary",className:{container:"w-full"},value:t}),d(s.S5,null,d("span",{className:"absolute left-2 top-2 text-text-quaternary typo-caption1"},"Fetching preview, please hold..."),d("div",{className:"flex flex-1 flex-col typo-footnote"},d("div",{className:"flex-flex-col relative"},d(o.f,{className:"h-2 w-5/6 rounded-12"}),d(o.f,{className:"mt-3 h-2 w-1/2 rounded-12"}))),d("div",{className:s.JE}),d(u.zx,{variant:c.Wu.Tertiary,icon:d(i.h,null),disabled:!0,type:"button",tag:"a",target:"_blank",rel:"noopener noreferrer",href:t})))}},25665:(e,t,n)=>{n.d(t,{$i:()=>o,JE:()=>l,S5:()=>i});var r=n(58519),a=n(45557),l="w-28 h-16 rounded-12 bg-text-disabled object-cover",o=(0,r.Z)(a.Ht,"rounded-16 border border-border-subtlest-tertiary"),i=(0,r.Z)(a.gq,"relative gap-3 items-center py-5 px-4")},513:(e,t,n)=>{n.d(t,{g:()=>l});var r=n(3376),a=n(78838),l=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1e3;return(0,r.Z)((function(n){return(0,a.HH)(n)&&t(n)?e(n):null}),n)}},90120:(e,t,n)=>{n.d(t,{x:()=>w});var r=n(93309),a=n(28076),l=n(62699),o=n.n(l),i=n(42135),s=n(78487),u=n(44194),c=n(45794),d=n(8421),m=n(97343),p=n(47831),f=n(62567),v=n(14960),y=n(53679),g=n(22925);function h(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function b(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?h(Object(n),!0).forEach((function(t){(0,a.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):h(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var w=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.callback,n=e.onPostSuccess,a=e.initialPreview,l=(0,m.sW)().displayToast,h=(0,v.Eu)().user,w=(0,i.NL)(),x=(0,y.o)().completeAction,S=(0,u.useState)(a),N=S[0],P=S[1],k=(0,g.Y)().requestMethod,C=(0,s.D)((function(e){return(0,c.v1)(e,k)}),{onSuccess:function(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];var a=n[0],l=n[1];P(b(b({},a),{},{url:l})),null!=t&&t.onSuccess&&t.onSuccess.apply(t,n)},onError:function(e,n){var r,a,o=(0,d.tf)(e,d.MS.RateLimited),i=null!==(r=null==o?void 0:o.message)&&void 0!==r?r:d.JV;l(i);for(var s=arguments.length,u=new Array(s>2?s-2:0),c=2;c<s;c++)u[c-2]=arguments[c];null==t||null===(a=t.onError)||void 0===a||a.call.apply(a,[t,e,n].concat(u))}}),O=C.mutateAsync,E=C.isLoading,L=function(){var e=(0,r.Z)(o().mark((function e(){var t=arguments;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return l(t.length>0&&void 0!==t[0]&&t[0]?"The post has been updated":"This post has been shared to your squad"),e.next=4,w.invalidateQueries(["sourceFeed",h.id]);case 4:x(f.Us.SquadFirstPost);case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),_=(0,s.D)((0,p.nf)(k),{onSuccess:function(e){L(),n&&n(e,null==e?void 0:e.permalink)}}),j=_.mutateAsync,q=_.isLoading,D=_.isSuccess,T=(0,s.D)((0,p.EM)(k),{onSuccess:function(e){L(!0),n&&n(e,null==e?void 0:e.permalink)}}),z=T.mutateAsync,Z=T.isLoading,A=T.isSuccess,I=(0,s.D)((function(e){return(0,c.m5)(e,k)}),{onSuccess:function(e,t){var r=t.url;L(),n&&n(null,r)}}),R=I.mutateAsync,M=I.isLoading,F=I.isSuccess,U=q||M||D||F,W=A||Z;return{isLoadingPreview:E,getLinkPreview:O,onSubmitPost:(0,u.useCallback)((function(e,t,n){if(null==e||e.preventDefault(),U)return null;if(N.id)return j({id:N.id,sourceId:t,commentary:n});var r=N.title,a=N.image,o=N.url;return r?R({url:o,title:r,image:a,sourceId:t,commentary:n}):(l("Invalid link"),null)}),[N,l,R,j,U]),onUpdatePost:(0,u.useCallback)((function(e,t,n){return e.preventDefault(),W?null:z({id:t,commentary:n})}),[z,W]),isPosting:U,preview:N,onUpdatePreview:P}}}}]);